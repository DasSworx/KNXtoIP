Adressbereich von KNX: 16 bit
Adressbereich von IP: 32 bit
Adressbereich von loopBack: 24 (127.0.0.1/8)

Funktionen, die im Ethernet-Header übernommen werden:
    Broadcastflag?

Funktionen die im IP-Header übernommen werden:
    Destination und Source-Adresse,
    TTL/Hop-Count
    Frame-Length
    Checksum

Funktionen die im TCP/UDP-Header übernommen werden:
    Flags für Ack/Fin/etc.
    Confirmation messages

Funktionen, die nicht übernommen werden können:
    - Repeat Flag!
    - Priority?





Idee:   die letzten 16 bit der IP-Adresse werden von der KNX Adresse belegt,
        die 16 davor können mit einem beliebigen Netzwerk belegt werden, dass dann von Snort
        beobachtet wird.

        Verschlüsselung muss nur erkannt werden -> Entschlüsselung, anschließend Übersetzung

        Nachfragen, was man bei Falsch gesetzter Länge von KNX Packeten tun soll:
            Aktive Erkennung des Problems und übertragung auf IP?
            Problem zu irrelevant um behandelt zu werden

        Checksum in KNX and IP have the same behaviour: packages are silently dropped.
        Therefor we can match a faulty checksum in KNX to a faulty one in IP.


Einstellungen:
    Adresse zum empfangen von KNX-Packeten (vorzugsweise NUR KNX-Packeten)
    Adresse zum versenden an Snort

Allgemein:
    Die Länge muss nicht manuell konvertiert werden, da Scapy diese automatisch korrekt setzt. Wenn sie in KNX-Fehlerhaft gesetzt wäre,
    scheitert die Übertragung an der checksum, welche wiederum konvertiert wird.

Tests:
    Künstliche Pakete erstellen:
        Standard/Extended/Ack
        Broadcast/Single-Cast
        Encrypted/Klartext
        Checksum/CRC korrekt/nicht korrekt

Paketstruktur:
    Pakete sind:
        Entweder L_Data_Frame (Standard oder Extended) oder L_Poll Frame oder Acks


Snort:

existiert unter which Snort
Der Ordner mit den Regeln ist: /usr/local/etc/snort/rules/local.rules
Unter /usr/local/etc/snort gibt es eine Datei snort.lua, welche die Hauptconfig darstellt
Anscheinend werden Pakete noch nicht richtig an Snort übergeben. Das muss sich noch angeschaut werden


TODO: find a way to deal with non-KNX frames in network and deal with KNX-Acks and other unwanted frames